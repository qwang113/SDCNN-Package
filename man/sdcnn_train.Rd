% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sdcnn_train.R
\name{sdcnn_train}
\alias{sdcnn_train}
\title{Train a Spatial Deep Convolutional Neural Network (SDCNN) proposed by Qi Wang, Paul A. Parker, and Robert Lund. "Spatial deep convolutional neural networks." Spatial Statistics (2025): 100883.}
\usage{
sdcnn_train(
  coords,
  X = NULL,
  y,
  venv,
  basis_kernel = "Gaussian",
  pred_drop = 0.1,
  train_prop = 0.9,
  model_saving_path = here::here(),
  optimizer = "adam",
  loss_fun = "mse",
  epoch = 10,
  bat_size = 1000
)
}
\arguments{
\item{coords}{A matrix (n x 2) where the first column is longitude and the second column is latitude, and n is the number of observations.}

\item{X}{A matrix (n x p) of covariates, or NULL. Note that longitude and latitude has been included by default. This matrix stands for other covariates.}

\item{y}{A numeric vector (n x 1) of response values.}

\item{venv}{The name of the Conda virtual environment to use. Note only specific combination of packages is working, for the environment that the authors are using, refer to: https://github.com/qwang113/Spatial-Deep-Convolutional-Neural-Networks/blob/main/tf_gpu.yaml}

\item{basis_kernel}{The kernel type for basis function construction (default is "Gaussian"). Possible choices are discussed in the FRK::auto_basis() function.}

\item{pred_drop}{Dropout rate for prediction layers.}

\item{train_prop}{The proportion of data used for training (default 0.9). The rest are used to apply early stopping}

\item{model_saving_path}{Path for saving the model (default: current directory).}

\item{optimizer}{Optimization method (default: "adam"). For more options refer to keras::compile().}

\item{loss_fun}{Loss function for training (default: "mse"). For more options refer to keras::compile().}

\item{epoch}{Number of training epochs.}

\item{bat_size}{Batch size.}
}
\value{
A list containing:
\describe{
  \item{model}{A trained SDCNN model (Keras model object).}
  \item{min_max_scale_min}{The minimum values used for min-max scaling.}
  \item{min_max_scale_range}{The range of values used for min-max scaling.}
  \item{shape_1}{A length 2 vector, represents the dimensions of the basis funcitons on the first resolution.}
  \item{shape_2}{A length 2 vector, represents the dimensions of the basis funcitons on the second resolution.}
  \item{shape_3}{A length 2 vector, represents the dimensions of the basis funcitons on the third resolution.}
  \item{fun_res1}{A list of the first resolution of spatial basis functions used in training.}
  \item{fun_res2}{A list of the second resolution of spatial basis functions used in training.}
  \item{fun_res3}{A list of the third resolution of spatial basis functions used in training.}
}
}
\description{
This function trains an SDCNN model for spatial prediction.
}
\examples{
\dontrun{
eh_dat <- SDCNN::eh_dat
basis_kernel = "Gaussian"
venv = "tf_gpu"
coords <- eh_dat[,1:2]
y <- eh_dat[,3]
pred_drop <- 0.1
train_prop <- 0.9
model_saving_path <- here::here()
X <- NULL
optimizer = "adam"
loss_fun = "mse"
epoch = 1000
bat_size = 1000
model <- sdcnn_train(coords, X = NULL, y, venv, basis_kernel = "Gaussian", pred_drop = 0.1, train_prop = 0.9,model_saving_path = here::here(), optimizer = "adam", loss_fun = "mse", epoch = 10, bat_size = 1000)
}
}
